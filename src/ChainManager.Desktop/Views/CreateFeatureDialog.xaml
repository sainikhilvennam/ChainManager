<Window x:Class="ChainManager.Desktop.Views.CreateFeatureDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Create Feature Chain" Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- JIRA ID -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="JIRA ID:" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBox x:Name="JiraIdTextBox" Text="{Binding JiraId, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock Text="(e.g., DEPM-12345 or just 12345)" FontSize="11" Foreground="Gray" Margin="0,2,0,0"/>
        </StackPanel>
        
        <!-- Feature Name -->
        <StackPanel Grid.Row="1" Margin="0,0,0,15">
            <TextBlock Text="Feature Name (Optional):" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBox x:Name="FeatureNameTextBox" Text="{Binding FeatureName, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock Text="(Used for filename: JIRA-ID-feature-name.properties)" FontSize="11" Foreground="Gray" Margin="0,2,0,0"/>
        </StackPanel>
        
        <!-- Target Project -->
        <StackPanel Grid.Row="2" Margin="0,0,0,15">
            <TextBlock Text="Target Project:" FontWeight="Bold" Margin="0,0,0,5"/>
            <ComboBox x:Name="TargetProjectComboBox" ItemsSource="{Binding AvailableProjectNames}" 
                     SelectedItem="{Binding SelectedTargetProject, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock Text="(Main project where this feature will be developed)" FontSize="11" Foreground="Gray" Margin="0,2,0,0"/>
        </StackPanel>
        
        <!-- Projects Selection -->
        <StackPanel Grid.Row="3" Margin="0,0,0,10">
            <TextBlock Text="Select Projects:" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBlock Text="Choose which projects to include in this feature chain:" FontSize="11" Foreground="Gray" Margin="0,0,0,5"/>
        </StackPanel>
        
        <Border Grid.Row="4" BorderBrush="Gray" BorderThickness="1" Margin="0,0,0,15">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <DataGrid ItemsSource="{Binding AvailableProjects}" AutoGenerateColumns="False" 
                         CanUserAddRows="False" GridLinesVisibility="Horizontal" RowHeight="30">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsSelected}" Width="60"/>
                        <DataGridTextColumn Header="Project" Binding="{Binding ProjectName}" IsReadOnly="True" Width="120"/>
                        <DataGridTemplateColumn Header="Mode" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding DataContext.AvailableModes, RelativeSource={RelativeSource AncestorType=Window}}"
                                             SelectedItem="{Binding SelectedMode, UpdateSourceTrigger=PropertyChanged}"
                                             IsEnabled="{Binding IsSelected}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Fork" Width="180">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding DataContext.AvailableForks, RelativeSource={RelativeSource AncestorType=Window}}"
                                             SelectedItem="{Binding SelectedFork, UpdateSourceTrigger=PropertyChanged}"
                                             IsEditable="True" IsEnabled="{Binding IsSelected}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Branch" Width="180">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding DataContext.AvailableBranches, RelativeSource={RelativeSource AncestorType=Window}}"
                                             SelectedItem="{Binding SelectedBranch, UpdateSourceTrigger=PropertyChanged}"
                                             IsEditable="True" IsEnabled="{Binding IsSelected}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridCheckBoxColumn Header="Tests" Binding="{Binding UseTests}" Width="60"/>
                    </DataGrid.Columns>
                </DataGrid>
            </ScrollViewer>
        </Border>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Select All" Click="SelectAll_Click" Margin="0,0,10,0" Padding="10,5"/>
            <Button Content="Clear All" Click="ClearAll_Click" Margin="0,0,20,0" Padding="10,5"/>
            <Button Content="Create" Click="Create_Click" IsDefault="True" Padding="15,5" Margin="0,0,10,0"/>
            <Button Content="Cancel" Click="Cancel_Click" IsCancel="True" Padding="15,5"/>
        </StackPanel>
    </Grid>
</Window>